<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gerenciador RadarSiope</title>
  <link rel="stylesheet" href="style.css">
  <style>
    :root {
      --accent: #007acc;
      --accent-dark: #005fa3;
      --bg: #f4f4f4
    }

    * {
      box-sizing: border-box
    }

    body {
      font-family: sans-serif;
      margin: 0;
      padding: 0;
      background: var(--bg);
      display: flex;
      min-height: 100vh
    }

    aside#sidebar {
      width: 220px;
      background: var(--accent);
      color: #fff;
      padding: 18px;
      flex: 0 0 220px
    }

    aside#sidebar h2 {
      margin: 0 0 12px;
      font-size: 16px
    }

    aside#sidebar button {
      display: block;
      width: 100%;
      text-align: left;
      padding: 10px;
      border: 0;
      background: transparent;
      color: #fff;
      border-radius: 6px;
      cursor: pointer;
      margin-bottom: 6px
    }

    aside#sidebar button:hover {
      background: rgba(255, 255, 255, 0.05)
    }

    aside#sidebar button.active {
      background: var(--accent-dark)
    }

    main#conteudo {
      flex: 1;
      padding: 18px;
      overflow: auto
    }

    section {
      display: none
    }

    .card {
      background: #fff;
      border-radius: 8px;
      padding: 12px;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.06);
      margin-bottom: 12px
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff
    }

    th,
    td {
      border: 1px solid #ddd;
      padding: .5em;
      text-align: left;
      vertical-align: top
    }

    .icon-btn {
      cursor: pointer;
      margin-right: .3em
    }

    input[type="text"] {
      padding: .4em;
      width: 100%;
      max-width: 420px;
      margin: 8px 0;
      display: inline-block
    }

    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, .5);
      align-items: center;
      justify-content: center;
      z-index: 1000
    }

    .modal-overlay.show {
      display: flex
    }

    .modal {
      background: #fff;
      border-radius: 6px;
      max-width: 900px;
      max-height: 90%;
      overflow: auto;
        
  width: 100%;
  height: 100%;
  padding: 20px;
  box-sizing: border-box;
    }

    .field {
      margin-bottom: .6em
    }

    .field label {
      display: block;
      font-weight: 600;
      margin-bottom: .25em
    }

    .field input,
    .field select,
    .field textarea {
      width: 100%;
      padding: .45em;
      border: 1px solid #ccc;
      border-radius: 4px
    }

    .modal-buttons {
      text-align: right;
      margin-top: 12px
    }

    .modal-buttons button {
      padding: .5em 1em;
      margin-left: .4em
    }

    /* small responsive */
    @media (max-width:760px) {
      aside#sidebar {
        display: none
      }
    }

    .lead-Emcontato {
      background-color: #e6ffe6;

      td:has(.preferencia-email) {
        background-color: #f0f8ff;
      }

      td:has(.preferencia-whatsapp) {
        background-color: #e6ffe6;
      }

      td:has(.preferencia-ligacao) {
        background-color: #fff0f0;
      }
    }

    #btn-toggle-filtro {
      background-color: #eaf1ff;
      color: #2c3e50;
      border: 1px solid #b0c4de;
      padding: 8px 14px;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    #btn-toggle-filtro.filtro-ativo {
      background-color: #007acc;
      color: white;
      border-color: #005fa3;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.4);
      justify-content: center;
      align-items: center;
      z-index: 10000;
      /* maior que o modal de contato */
    }

    .modal-overlay.hidden {
      display: none;
    }

    .modal-overlay.visible {
      display: flex;
    }

    .modal {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      max-width: 600px;
      width: 90%;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    }

    #modal-importacao-leads {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    #modal-importacao-leads .modal-conteudo {
      background: white;
      padding: 30px;
      border-radius: 8px;
      max-width: 90vw;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    }

    .painel-container {
      padding: 20px;
      background-color: #f4f4f4;
    }

    .graficos-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
    }

    .grafico-card {
      background: #fff;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .abas-navegacao {
      margin-bottom: 20px;
    }

    .abas-navegacao button {
      margin-right: 10px;
      padding: 8px 12px;
      cursor: pointer;
    }
.modal-overlay {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  width: 480px;
  max-width: 100%;
  height: 100%;
  background: #fff;
  box-shadow: -4px 0 12px rgba(0,0,0,0.2);
  z-index: 9999;
  overflow-y: auto;
  transform: translateX(100%);
  transition: transform 0.3s ease, visibility 0.3s ease, opacity 0.3s ease;
  visibility: hidden;
  opacity: 0;
}

.modal-overlay.aberto {
  transform: translateX(0);
  visibility: visible;
  opacity: 1;
}


    
  </style>
</head>

<body>
  <script>
    const usuario = JSON.parse(localStorage.getItem("usuarioLogado") || "{}");
    const perfil = (usuario.tipo_perfil || "").toLowerCase();

    if (perfil !== "admin") {
      alert("Acesso restrito. Redirecionando...");
      window.location.href = "login.html";
    }
  </script>

  <aside id="sidebar" aria-label="Menu">
    <h>Admin RadarSiope</h>
    <div id="usuario-logado-topo" style="padding: 10px; background: #007acc; font-size: 1em; font-weight: bold;">
      <!-- Nome do usuÃ¡rio serÃ¡ inserido aqui -->
    </div>

    <hr style="margin: 30px 0;">

    <button onclick="abrirTab('usuarios')" class="active">ğŸ‘¥ UsuÃ¡rios</button>
    <button onclick="abrirTab('relatorio-avaliacoes')">ğŸ—³ï¸ RelatÃ³rio de AvaliaÃ§Ãµes</button>
    <button onclick="abrirTab('leads')">ğŸ“¥ Leads Capturados</button>
    <button onclick="abrirTab('auditoria')">ğŸ•µï¸ Auditoria Leads</button>
    <button onclick="abrirEnvioNewsletterLeads()">ğŸ“® Enviar Newsletters para Leads</button>
    <button onclick="abrirPainelGestao()">ğŸ—ï¸ Painel</button>

    <div style="margin-top:12px">
      <h2 style="font-size:14px;margin-bottom:6px">RelatÃ³rio de PreferÃªncias</h2>
      <button onclick="abrirTab('relatorio-por-tipo')">ğŸ“Š Por Tipo de Newsletters</button>
      <button onclick="abrirTab('relatorio-por-usuario')">ğŸ‘¤ Por UsuÃ¡rio</button>
    </div>
    <div style="margin-top:12px">
      <h2 style="font-size:14px;margin-bottom:6px">Tabelas</h2>
      <button onclick="abrirTab('newsletters')">ğŸ“° Newsletters</button>
      <button onclick="abrirTab('tipo-newsletters')">ğŸ“‚ Tipo de Newsletters</button>
      <button onclick="abrirTab('planos')">ğŸ“‘ Planos</button>
      <button onclick="abrirTab('respostas_automaticas')">âœ‰ï¸ Respostas AutomÃ¡ticas</button>
    </div>
    <button onclick="abrirTab('aba-temas')">ğŸ—ï¸ NotÃ­cias</button>
    
    <hr style="margin: 30px 0;">
    <h3>ğŸ” MigraÃ§Ã£o de Senhas Antigas</h3>
    <p>Atualize todas as senhas salvas em texto puro para SHA-256.</p>
    <button onclick="migrarSenhasAntigas()">ğŸ”„ Migrar Senhas</button>
    <button onclick="Atualizarnomelower()">ğŸ”„ Atualizar nome lower</button>
    <div id="status-migracao" style="margin-top: 10px; font-weight: bold;"></div>

    <button onclick="fazerLogoff()">ğŸšª Sair da Ãrea Administrativa</button>
    <div id="status-logoff" style="margin-top: 10px; font-weight: bold;"></div>
  </aside>

  <main id="conteudo">
    <!-- Enviar Newsletters para Leads -->
    <section id="secao-envio-newsletters" style="display:none">
      <div class="abas-navegacao">
        <button onclick="mostrarAba('secao-newsletters-envio')">ğŸ“° Newsletters DisponÃ­veis</button>
        <button onclick="abrirAbaDescadastramentos()">ğŸ“‰ Descadastramentos</button>
      </div>
      <div id="dados-newsletter-selecionada" class="info-box"
        style="margin-bottom:20px; background:#eef; padding:10px; border-left:4px solid #88f;">
        <!-- preenchido via JS -->
      </div>

      <section id="secao-newsletters-envio" style="margin-top:30px">
        <h2>ğŸ“° Newsletters DisponÃ­veis</h2>

        <table id="tabela-newsletters-envio" class="tabela-padrao">
          <thead>
            <tr>
              <th>TÃ­tulo</th>
              <th>Tipo</th>
              <th>EdiÃ§Ã£o</th>
              <th>Data</th>
              <th>AÃ§Ãµes</th>
            </tr>
          </thead>
          <tbody>
            <!-- conteÃºdo gerado dinamicamente via JavaScript -->
          </tbody>
        </table>
      </section>

      <section id="secao-envio-leads" style="display:none; margin-top:30px">
        <h2>ğŸ“® Envio de Newsletters para Leads</h2>


        <!-- Filtros -->
        <div style="margin-bottom: 15px">
          <input type="text" id="filtro-nome" placeholder="ğŸ” Filtrar por nome" style="margin-right:10px" />
          <input type="text" id="filtro-email" placeholder="ğŸ“§ Filtrar por e-mail" style="margin-right:10px" />
          <button onclick="filtrarLeadsEnvio()">ğŸ” Aplicar Filtros</button>
        </div>
        <!-- AÃ§Ãµes -->
        <div style="margin-top: 20px">
          <button onclick="gerarPreviaEnvio()">ğŸ“¬ Gerar PrÃ©via</button>
          <button onclick="mostrarAba('secao-newsletters-envio')">â¬…ï¸ Voltar para Newsletters</button>
        </div>

        <!-- Tabela de leads -->
        <table id="tabela-leads-envio" class="tabela-padrao">
          <thead>
            <tr>
              <th>
                <input type="checkbox" id="chk-todos-leads" onchange="selecionarTodosLeads(this)" />
              </th>
              <th>Nome</th>
              <th>Email</th>
              <th>Perfil</th>
              <th>PreferÃªncias</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <!-- preenchido dinamicamente -->
          </tbody>
        </table>

      </section>

      <section id="secao-preview-envio" style="display:none; margin-top:30px">
        <h2>ğŸ“¬ PrÃ©via do Envio</h2>
        <div style="margin-top: 20px">
          <button onclick="enviarNewslettersParaLeads()">ğŸš€ Enviar Newsletters</button>
          <button onclick="mostrarAba('secao-envio-leads')">â¬…ï¸ Voltar para Envio</button>
        </div>
        <table id="tabela-preview-envio" class="tabela-padrao">
          <thead>
            <tr>
              <th><input type="checkbox" id="chk-todos-envios" onchange="selecionarTodosEnvios(this)" /></th>
              <th>Lead</th>
              <th>Email</th>
              <th>Newsletter</th>
              <th>Interesses</th>
              <th>CompatÃ­vel</th>
            </tr>
          </thead>
          <tbody>
            <!-- preenchido dinamicamente pela funÃ§Ã£o gerarPreviaEnvio() -->
          </tbody>
        </table>
      </section>

      <section id="secao-relatorio-envios" style="display:none; margin-top:30px">
        <h2>ğŸ“Š RelatÃ³rio de Envios</h2>

        <!-- Filtro por e-mail -->
        <div style="margin-bottom:15px">
          <input type="text" id="filtro-relatorio-email" placeholder="ğŸ“§ Filtrar por e-mail"
            style="margin-right:10px" />
          <button onclick="carregarRelatorioEnvios()">ğŸ” Buscar</button>
        </div>

        <!-- Tabela de envios -->
        <table id="tabela-relatorio-envios" class="tabela-padrao">
          <thead>
            <tr>
              <th>Lead</th>
              <th>Email</th>
              <th>Newsletter</th>
              <th>Data de Envio</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <!-- preenchido dinamicamente -->
          </tbody>
        </table>
      </section>

      <section id="secao-descadastramentos" style="display:none; margin-top:30px">
        <h2>ğŸ“‰ Descadastramentos</h2>

        <table id="tabela-descadastramentos" class="tabela-padrao">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Email</th>
              <th>Newsletter</th>
              <th>Data</th>
              <th>Motivo</th>
            </tr>
          </thead>
          <tbody>
            <!-- preenchido dinamicamente -->
          </tbody>
        </table>
      </section>

      <section id="secao-preview-envio" style="display:none; margin-top:30px">
        <h2>ğŸ“¬ PrÃ©via do Envio</h2>
        <table id="tabela-preview-envio" class="tabela-padrao">
          <thead>
            <tr>
              <th><input type="checkbox" id="chk-todos-envios" onchange="selecionarTodosEnvios(this)" /></th>
              <th>Lead</th>
              <th>Email</th>
              <th>Newsletter</th>
              <th>Interesses</th>
              <th>CompatÃ­vel</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>

      <section id="secao-envio-leads" style="display:none; margin-top:30px">
        <script src="js/EnvioLeads.js"></script>
        <h2>ğŸ“® Envio de Newsletters para Leads</h2>
        <div style="margin-bottom: 15px">
          <input type="text" id="filtro-relatorio-email" placeholder="ğŸ“§ Filtrar por e-mail"
            style="margin-right:10px" />
          <button onclick="carregarRelatorioEnvios()">ğŸ“‹ Listar Envios</button>
        </div>

        <table id="tabela-leads-envio" class="tabela-padrao">
          <thead>
            <tr>
              <th>Selecionar</th>
              <th>Nome</th>
              <th>Email</th>
              <th>Perfil</th>
              <th>PreferÃªncias</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>

      <!-- Relatorio de envio de News Letter para Leads -->
      <section id="secao-relatorio-envios" style="margin-top:30px">
        <h2>ğŸ“Š RelatÃ³rio de Envios</h2>

        <div style="margin-bottom:15px">
          <input type="text" id="filtro-relatorio-email" placeholder="ğŸ“§ Filtrar por e-mail"
            style="margin-right:10px" />
          <button onclick="carregarRelatorioEnvios()">ğŸ” Buscar</button>
        </div>

        <table id="tabela-relatorio-envios" class="tabela-padrao">
          <thead>
            <tr>
              <th>Lead</th>
              <th>Email</th>
              <th>Newsletter</th>
              <th>Data de Envio</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>
    </section>

    <!-- USUÃRIOS -->
    <section id="usuarios" class="card">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <h3 style="margin:0">ğŸ‘¥ UsuÃ¡rios</h3>
        <button onclick="abrirModalCriarUsuario()">â• Novo UsuÃ¡rio</button>
      </div>

      <!-- Filtros e busca -->
      <div style="margin-top:10px; display:flex; flex-wrap:wrap; gap:10px; align-items:center;">

        <input type="text" id="busca-usuarios" placeholder="Buscar usuÃ¡rio..." onkeyup="filtrarUsuarios()"
          style="flex:1; min-width:200px;">
        <label>Status:
          <select id="filtro-status">
            <option value="">Todos</option>
            <option value="ativo">Ativos</option>
            <option value="inativo">Inativos</option>
          </select>
        </label>

        <label for="filtro-vencidos" style="color:#f44336">
          <input type="checkbox" id="filtro-vencidos"> Parcelas vencidas
        </label>
        <label for="filtro-semvalor" style="color:#2196f3">
          <input type="checkbox" id="filtro-semvalor"> Parcelas a gerar
        </label>
        <label for="filtro-solicitacoes" style="color:#ff9800">
          <input type="checkbox" id="filtro-solicitacoes"> SolicitaÃ§Ãµes pendentes
        </label>

        <!-- BotÃµes de aÃ§Ã£o e navegaÃ§Ã£o -->
        <div style="display:flex; gap:10px; align-items:center;">
          <button id="btn-listar" onclick="iniciarConsultaUsuarios()">ğŸ” Listar</button>
          <button id="btn-anterior" onclick="irParaPaginaAnterior()" disabled>â—€ Anterior</button>
          <button id="btn-proxima" onclick="carregarUsuariosComFiltro()" disabled>â–¶ PrÃ³xima</button>
          <button id="btn-primeira" onclick="irParaPrimeiraPagina()" disabled>â® Primeira</button>

          <span id="status-consulta" style="font-style:italic; color:#555;"></span>
          <progress id="barra-progresso" value="0" max="100" style="width:100%; display:none;"></progress>
        </div>
      </div>

      <!-- Tabela -->
      <table style="margin-top:10px; width:100%; border-collapse:collapse;">
        <thead>
          <tr>
            <th>Nome</th>
            <th>Email</th>
            <th>UF</th>
            <th>MunicÃ­pio</th>
            <th>Perfil</th>
            <th>Ativo</th>
            <th>Alerta</th>
            <th>AÃ§Ãµes</th>
          </tr>
        </thead>
        <tbody id="lista-usuarios"></tbody>
      </table>
    </section>


    <!-- Auditoria Leads capturados -->
    <section id="auditoria" class="card">
      <div>
        <h2>ğŸ•µï¸ Painel de Auditoria</h2>
        <p>Veja todas as interaÃ§Ãµes registradas no sistema.</p>
        <div id="filtros-auditoria" style="margin-bottom: 20px;">
          <label>Tipo:
            <select id="filtro-tipo">
              <option value="">Todos</option>
              <option value="vinculacao">VinculaÃ§Ã£o</option>
              <option value="reativacao">ReativaÃ§Ã£o</option>
              <option value="E-mail">E-mail</option>
            </select>
          </label>

          <label>Feito por:
            <input type="text" id="filtro-feito-por" placeholder="Nome ou e-mail">
          </label>

          <label>Lead:
            <input type="text" id="filtro-lead" placeholder="Nome do lead">
          </label>

          <button onclick="carregarInteracoesAuditoria()">ğŸ” Filtrar</button>
        </div>

        <div id="tabela-interacoes" style="margin-top: 20px;"></div>
      </div>

    </section>

    <!-- PLANOS -->
    <section id="planos" class="card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <h3 style="margin:0">ğŸ“‘ Planos</h3>
        </div>
        <div><button onclick="abrirModalPlano()">â• Novo Plano</button></div>
      </div>
      <div style="margin-top:10px">
        <input type="text" id="busca-planos" placeholder="Buscar plano..." onkeyup="filtrarPlanos()">
      </div>
      <table style="margin-top:10px">
        <thead>
          <tr>
            <th>Nome</th>
            <th>DescriÃ§Ã£o</th>
            <th>Qtde Parcelas</th>
            <th>Tipo</th>
            <th>Valor</th>
            <th>Status</th>
            <th>AÃ§Ãµes</th>
          </tr>
        </thead>
        <tbody id="lista-planos"></tbody>
      </table>
    </section>

    <!-- NEWSLETTERS -->
    <section id="newsletters" class="card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <h3 style="margin:0">ğŸ“° Newsletters</h3>
        </div>
        <div><button onclick="abrirModalNewsletter()">â• Nova Newsletter</button></div>
      </div>

      <div class="filtros-newsletters" style="margin: 20px 0;">
        <label for="filtro-tipo-news">Tipo:</label>
        <select id="filtro-tipo-news">
          <option value="">Todos os tipos</option>
        </select>

        <label for="filtro-classificacao">ClassificaÃ§Ã£o:</label>
        <select id="filtro-classificacao">
          <option value="">Todas</option>
          <option value="BÃ¡sica">BÃ¡sica</option>
          <option value="Premium">Premium</option>
        </select>

        <label for="filtro-busca">Busca:</label>
        <input type="text" id="filtro-busca" placeholder="Buscar por tÃ­tulo ou ediÃ§Ã£o">

        <button onclick="carregarNewsletters()">Filtrar</button>
      </div>

      <table style="margin-top:10px; width: 100%; border-collapse: collapse;">
        <thead>
          <tr>
            <th>Data</th>
            <th>EdiÃ§Ã£o</th>
            <th>TÃ­tulo</th>
            <th>Tipo</th>
            <th>ClassificaÃ§Ã£o</th>
            <th>AÃ§Ãµes</th>
          </tr>
        </thead>
        <tbody id="lista-newsletters"></tbody>
      </table>
    </section>


    <div id="modal-html-preview" class="modal-overlay"
      style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.6); z-index:9999;">
      <div class="modal-content"
        style="background:#fff; padding:20px; max-width:800px; margin:80px auto; border-radius:8px; box-shadow:0 0 20px rgba(0,0,0,0.3); position:relative;">
        <span class="modal-close" onclick="document.getElementById('modal-html-preview').style.display='none'"
          style="position:absolute; top:10px; right:15px; font-size:24px; cursor:pointer;">âŒ Fechar</span>
        <iframe id="iframe-html-preview"
          style="width:100%; height:400px; border:1px solid #ccc; border-radius:4px;"></iframe>
      </div>
    </div>


    <!-- TIPO NEWSLETTERS -->
    <section id="tipo-newsletters" class="card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <h3 style="margin:0">ğŸ“‚ Tipos de NewsLetters</h3>
        </div>
        <div><button onclick="abrirModalTipoNewsletter()">â• Novo Tipo</button></div>
      </div>
      <div style="margin-top:10px">
        <input type="text" id="busca-tipo-newsletters" placeholder="Buscar tipo..." onkeyup="filtrarTipoNewsletters()">
      </div>
      <table style="margin-top:10px">
        <thead>
          <tr>
            <th>Nome</th>
            <th>Ã‰ Newsletter?</th>
            <th>AÃ§Ãµes</th>
          </tr>
        </thead>
        <tbody id="lista-tipo-newsletters"></tbody>
      </table>
    </section>

    <!-- RELATÃ“RIO DE PREFERÃŠNCIAS -->
    <section id="relatorio-preferencias" class="card">
      <div>
        <h3 style="margin:0">ğŸ“Š RelatÃ³rio de PreferÃªncias por Newsletter</h3>
      </div>
      <table style="margin-top:10px">
        <thead>
          <tr>
            <th>Tipo de Newsletter</th>
            <th>UsuÃ¡rios</th>
          </tr>
        </thead>
        <tbody id="tabela-relatorio-preferencias"></tbody>
      </table>
    </section>

    <!-- RELATÃ“RIO POR USUÃRIO -->
    <section id="relatorio-por-usuario" class="card">
      <div>
        <h3 style="margin:0">ğŸ‘¤ PreferÃªncias por UsuÃ¡rio</h3>
      </div>
      <div style="margin-top:10px">
        <input type="text" id="busca-relatorio-usuario" placeholder="Buscar usuÃ¡rio por nome, ID ou email..."
          style="width:100%;max-width:400px" onkeyup="filtrarRelatorioUsuarios()">
      </div>
      <table style="margin-top:10px">
        <thead>
          <tr>
            <th>Nome</th>
            <th>Email</th>
            <th>AÃ§Ãµes</th>
          </tr>
        </thead>
        <tbody id="tabela-relatorio-usuarios"></tbody>
      </table>
      <div id="detalhes-relatorio-usuario" style="margin-top:20px"></div>
    </section>

    <!-- RELATÃ“RIO POR TIPO -->
    <section id="relatorio-por-tipo" class="card">
      <div>
        <h3 style="margin:0">ğŸ“Š PreferÃªncias por Tipo de Newsletter</h3>
      </div>

      <div style="margin-top:10px">
        <label for="filtro-cad-tipo-newsletter""><strong>Filtrar por tipo:</strong></label>
        <select id=" filtro-cad-tipo-newsletter"">
          <option value="">Todos</option>
          </select>
          <button onclick="gerarRelatorioPreferencias()" style="margin-left:10px">ğŸ” Gerar RelatÃ³rio</button>
      </div>
      <table style="margin-top:10px">
        <thead>
          <tr>
            <th>Tipo</th>
            <th>UsuÃ¡rios</th>
          </tr>
        </thead>
        <tbody id="tabela-relatorio-por-tipo"></tbody>
      </table>
    </section>

    <!-- Respostas automaticas -->
    <section id="respostas_automaticas" style="display:none"></section>
    <div id="modalrespostaauto" style="
          display:none;
          position:fixed;
          top:0;
          left:0;
          width:100%;
          height:100%;
          background:rgba(0,0,0,0.5);
          z-index:9999;
          justify-content:center;
          align-items:center;
        ">
      <div class="modal-content" style="
            background:#fff;
            padding:20px;
            border-radius:8px;
            max-width:700px;
            width:90%;
            position:relative;
            box-shadow:0 0 20px rgba(0,0,0,0.3);
          ">
        <button onclick="fecharModalRespostaAuto()" style="
              position:absolute;
              top:10px;
              right:10px;
              font-size:18px;
              background:none;
              border:none;
              cursor:pointer;
            ">âŒ</button>
        <div id="modalrespostaauto-body"></div>
      </div>
    </div>


    <div id="modal-preview-html" style="
          display:none;
          position:fixed;
          top:0;
          left:0;
          width:100%;
          height:100%;
          background:rgba(0,0,0,0.6);
          z-index:9999;
          justify-content:center;
          align-items:center;
        ">
      <div style="
            background:#fff;
            padding:20px;
            border-radius:8px;
            max-width:800px;
            width:90%;
            overflow:auto;
            max-height:90vh;
            position:relative;
          ">
        <button onclick="fecharModalPreview()" style="
              position:absolute;
              top:10px;
              right:10px;
              font-size:18px;
              background:none;
              border:none;
              cursor:pointer;
            ">âŒ</button>
        <div id="preview-html-content"></div>
      </div>
    </div>

    </section>


    <!-- ğŸ”– Aba de Temas de NotÃ­cias -->
    <section id="aba-temas" class="card">
      <div>

        <h2>ğŸ—ï¸ Temas de NotÃ­cias</h2>
        <button onclick="editarTema()">â• Novo Tema</button>

        <table id="tabela-temas" style="width:100%;margin-top:20px;border-collapse:collapse">
          <!-- ConteÃºdo gerado dinamicamente pela funÃ§Ã£o carregarTemas_noticias() -->
        </table>
      </div>

      <!-- ğŸ§¾ Modal de ediÃ§Ã£o de tema -->
      <div id="modal-tema" style="
        display:none;
        position:fixed;
        top:0;
        left:0;
        width:100%;
        height:100%;
        background:rgba(0,0,0,0.5);
        z-index:9999;
        justify-content:center;
        align-items:center;
      ">
        <div style="
          background:#fff;
          padding:20px;
          border-radius:8px;
          max-width:600px;
          width:90%;
          position:relative;
          box-shadow:0 0 20px rgba(0,0,0,0.3);
        ">
          <button onclick="fecharModalTema()" style="
            position:absolute;
            top:10px;
            right:10px;
            font-size:18px;
            background:none;
            border:none;
            cursor:pointer;
          ">âŒ</button>
          <div id="modal-tema-body"></div>
        </div>
      </div>
    </section>
    <!-- LEADS -->
    <section id="leads" class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;margin:10px 0">
        <h3 style="margin:0">ğŸ“¥ Leads Capturados</h3>
        <div style="display:flex;align-items:center;gap:20px">
          <div id="resumo-leads" style="font-weight:bold;font-size:16px;text-align:right"></div>
          <button onclick="exportarLeadsCSV()"
            style="padding:8px 16px;background:#007acc;color:#fff;border:none;border-radius:6px">
            ğŸ“¤ Exportar para CSV
          </button>
          <button onclick="abrirModalImportacaoLeads()">ğŸ“¥ Importar Leads via Planilha</button>

        </div>
      </div>

      <div style="display:flex;gap:20px;align-items:flex-end;flex-wrap:wrap;margin:10px 0">
        <div style="flex:1;min-width:250px">
          <label for="busca-leads">Buscar por nome ou e-mail:</label>
          <input type="text" id="busca-leads" placeholder="Buscar..." onkeyup="filtrarLeads()" style="width:100%">
        </div>

        <div>
          <label for="filtro-perfil">Filtrar por perfil:</label>
          <select id="filtro-perfil">
            <option value="">Todos</option>
            <option value="secretario">SecretÃ¡rio</option>
            <option value="tecnico">TÃ©cnico</option>
            <option value="contador">Contador</option>
            <option value="pesquisador">Pesquisador</option>
            <option value="cacs">CACS</option>
            <option value="cidadao">CidadÃ£o</option>
          </select>
        </div>

        <div>
          <label for="filtro-preferencia">Filtrar por preferÃªncia de contato:</label>
          <select id="filtro-preferencia">
            <option value="">Todos</option>
            <option value="E-mail">ğŸ“§ E-mail</option>
            <option value="WhatsApp">ğŸ’¬ WhatsApp</option>
            <option value="LigaÃ§Ã£o">ğŸ“ LigaÃ§Ã£o</option>
          </select>
        </div>
        <div>
          <label>Status:
            <select id="filtro-status-lead">
              <option value="">Todos</option>
              <option value="Novo">Novo</option>
              <option value="Em contato">Em contato</option>
              <option value="Convertido">Convertido</option>
              <option value="Descartado">Descartado</option>
            </select>
          </label>
        </div>
        <button onclick="carregarLeads()">ğŸ” Buscar Leads</button>
      </div>
      <table>
        <thead>
          <tr>
            <th>Nome</th>
            <th>E-mail</th>
            <th>Telefone</th>
            <th>Perfil</th>
            <th>Interesses</th>
            <th>Data</th>
            <th>PreferÃªncia</th>
            <th>Mensagem</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="tabela-leads"></tbody>
      </table>

      <div id="modal-contato-lead" style="
        display:none;
        position:fixed;
        top:0;
        left:0;
        width:100%;
        height:100%;
        background:rgba(0,0,0,0.5);
        z-index:9999;
        justify-content:center;
        align-items:center;
      ">
        <div style="
          background:#fff;
          padding:20px;
          border-radius:8px;
          max-width:500px;
          width:90%;
          position:relative;
          box-shadow:0 0 20px rgba(0,0,0,0.3);
        ">
          <button onclick="fecharModalContatoLead()" style="
            position:absolute;
            top:10px;
            right:10px;
            font-size:18px;
            background:none;
            border:none;
            cursor:pointer;
          ">âŒ</button>
          <h3>ğŸ“ Registrar contato</h3>
          <div class="field">
            <label>Tipo de contato:</label>
            <input type="text" id="tipo-contato-lead" readonly
              style="background:#eee; padding:6px; border:1px solid #ccc; width:100%">
          </div>
          <div class="field" id="campo-email-lead" style="display:none">
            <label>E-mail do lead:</label>
            <input type="text" id="email-contato-lead" readonly
              style="background:#eee; padding:6px; border:1px solid #ccc; width:100%">
          </div>
          <div class="field">
            <label>Resultado do contato:</label>
            <textarea id="resultado-contato-lead" rows="4" style="width:100%"></textarea>
          </div>
          <div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px;">
            <div id="acao-email-lead" style="display:none">
              <button id="btn-enviar-email-lead">ğŸ“§ Enviar e-mail manual</button>
            </div>
            <button onclick="salvarInteracaoLead()">ğŸ’¾ Salvar interaÃ§Ã£o</button>
          </div>
          <div id="historico-interacoes-lead" style="margin-top:20px; max-height:300px; overflow-y:auto;"></div>
        </div>
      </div>

      <div id="modal-historico-lead" style="
        display:none;
        position:fixed;
        top:0;
        left:0;
        width:100%;
        height:100%;
        background:rgba(0,0,0,0.5);
        z-index:9999;
        justify-content:center;
        align-items:center;
      ">
        <div style="
          background:#fff;
          padding:20px;
          border-radius:8px;
          max-width:600px;
          width:90%;
          position:relative;
          box-shadow:0 0 20px rgba(0,0,0,0.3);
          max-height:80%;
          overflow-y:auto;
        ">
          <button onclick="fecharModalHistorico()" style="
            position:absolute;
            top:10px;
            right:10px;
            font-size:18px;
            background:none;
            border:none;
            cursor:pointer;
          ">âŒ</button>
          <h3>ğŸ“œ HistÃ³rico de InteraÃ§Ãµes</h3>
          <div id="conteudo-historico-lead"></div>
        </div>
      </div>
      <div id="modal-vincular-lead" style="
        display:none;
        position:fixed;
        top:0;
        left:0;
        width:100%;
        height:100%;
        background:rgba(0,0,0,0.5);
        z-index:9999;
        justify-content:center;
        align-items:center;
      ">
        <div style="
          background:#fff;
          padding:20px;
          border-radius:8px;
          max-width:600px;
          width:90%;
          position:relative;
          box-shadow:0 0 20px rgba(0,0,0,0.3);
          max-height:80%;
          overflow-y:auto;
        ">
          <button onclick="document.getElementById('modal-vincular-lead').style.display='none'" style="
            position:absolute;
            top:10px;
            right:10px;
            font-size:18px;
            background:none;
            border:none;
            cursor:pointer;
          ">âŒ</button>
          <h3>ğŸ‘¤ Vincular Lead a UsuÃ¡rio</h3>
          <div id="conteudo-vincular-lead" style="margin-top:10px"></div>
        </div>
      </div>
      <!-- Modal fora da tabela -->
      <div id="modal-importacao-leads" style="display:none;" class="modal">
        <div class="modal-conteudo">
          <h3>ğŸ“¥ Importar Leads</h3>
          <p>Selecione um arquivo <strong>.csv</strong> com os campos abaixo, separados por <code>;</code>:</p>

          <div style="overflow-x: auto; margin-bottom: 20px;">
            <table style="min-width: 1000px; border-collapse: collapse;">
              <thead>
                <tr>
                  <th>nome</th>
                  <th>email</th>
                  <th>telefone</th>
                  <th>perfil</th>
                  <th>preferencia_contato</th>
                  <th>interesses</th>
                  <th>mensagem</th>
                  <th>origem</th>
                  <th>Sigla_UF</th>
                  <th>codigo_UF</th>
                  <th>Nome_Municipio</th>
                  <th>codigo_municipio</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>JoÃ£o Silva</td>
                  <td>joao@email.com</td>
                  <td>11999999999</td>
                  <td>contador</td>
                  <td>WhatsApp</td>
                  <td>orÃ§amento, dÃºvidas</td>
                  <td>Quero mais informaÃ§Ãµes</td>
                  <td>Evento XPTO</td>
                  <td>SP</td>
                  <td>35</td>
                  <td>SÃ£o Paulo</td>
                  <td>3550308</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div id="progresso-importacao" style="margin-top: 20px; font-weight: bold;">
            â³ Processando: 0 / 0
          </div>
          <label for="origem-importacao">Origem dos leads:</label>
          <input type="text" id="origem-importacao" placeholder="Ex: Evento, Landing Page, IndicaÃ§Ã£o" required
            style="margin-bottom: 10px; width: 100%;">
          <input type="file" id="arquivo-leads" accept=".csv">
          <button onclick="processarImportacaoLeads()">ğŸš€ Importar</button>
          <button onclick="fecharModalImportacaoLeads()">Fechar</button>
        </div>
      </div>
      <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    </section>

    <section id="relatorio-avaliacoes" class="card">
      <h3>ğŸ—³ï¸ RelatÃ³rio de AvaliaÃ§Ãµes de Atendimento</h3>

      <div style="margin-bottom:10px;">
        <div style="margin-bottom:6px;">
          <strong>Filtrar por avaliaÃ§Ã£o:</strong><br>
          <button onclick="filtrarAvaliacoes('todos')">Todos</button>
          <button onclick="filtrarAvaliacoes('positivo')">ğŸ‘ Positiva</button>
          <button onclick="filtrarAvaliacoes('negativo')">ğŸ‘ Negativa</button>
        </div>

        <div style="margin-top:10px;">
          <strong>Filtrar por tipo:</strong><br>
          <button onclick="filtrarTipoSolicitacao('todos')">Todos</button>
          <button onclick="filtrarTipoSolicitacao('consultoria')">Consultoria</button>
          <button onclick="filtrarTipoSolicitacao('treinamento')">Treinamento</button>
          <button onclick="filtrarTipoSolicitacao('newsletters')">Newsletters</button>
          <button onclick="filtrarTipoSolicitacao('outros')">Outros</button>
        </div>
        <div style="margin-top:10px;">
          <strong>Filtrar por perÃ­odo:</strong><br>
          <button onclick="filtrarPeriodoAvaliacoes('todos')">Todos</button>
          <button onclick="filtrarPeriodoAvaliacoes('7')">Ãšltimos 7 dias</button>
          <button onclick="filtrarPeriodoAvaliacoes('30')">Ãšltimos 30 dias</button>
          <button onclick="filtrarPeriodoAvaliacoes('90')">Ãšltimos 90 dias</button>
        </div>
      </div>
      <div style="margin-top:10px;">
        <strong>Filtrar por perfil:</strong><br>
        <button onclick="filtrarPerfilAvaliacoes('todos')">Todos</button>
        <button onclick="filtrarPerfilAvaliacoes('secretario')">SecretÃ¡rio</button>
        <button onclick="filtrarPerfilAvaliacoes('tecnico')">TÃ©cnico</button>
        <button onclick="filtrarPerfilAvaliacoes('contador')">Contador</button>
        <button onclick="filtrarPerfilAvaliacoes('pesquisador')">Pesquisador</button>
        <button onclick="filtrarPerfilAvaliacoes('cacs')">CACS</button>
        <button onclick="filtrarPerfilAvaliacoes('cidadao')">CidadÃ£o</button>
      </div>

      <table style="margin-top:10px">
        <thead>
          <tr>
            <th>UsuÃ¡rio</th>
            <th>Perfil</th>
            <th>Tipo</th>
            <th>Status</th>
            <th>AvaliaÃ§Ã£o</th>
            <th>Data</th>
          </tr>
        </thead>
        <tbody id="tabela-avaliacoes"></tbody>
      </table>
    </section>

    <!-- Painel  -->
    <section id="painel-gestao" class="painel-container">
      <h2>Painel de GestÃ£o Geral</h2>
      <select id="filtro-periodo" onchange="atualizarGraficosPorPeriodo()">
        <option value="7">Ãšltimos 7 dias</option>
        <option value="30" selected>Ãšltimos 30 dias</option>
        <option value="90">Ãšltimos 90 dias</option>
        <option value="365">Ãšltimos 12 meses</option>
      </select>

      <div class="graficos-grid">
        <div class="grafico-card">
          <h3>ğŸ‘¥ UsuÃ¡rios (Ativos vs Inativos)</h3>
          <canvas id="grafico-usuarios"></canvas>
        </div>
        <div class="grafico-card">
          <h3>ğŸ“ˆ Leads por Status</h3>
          <canvas id="grafico-leads"></canvas>
        </div>
        <div class="grafico-card">
          <h3>ğŸ’° Pagamentos</h3>
          <canvas id="grafico-pagamentos"></canvas>
        </div>
        <div class="grafico-card">
          <h3>ğŸ“° Assinaturas por Tipo</h3>
          <canvas id="grafico-assinaturas"></canvas>
        </div>
        <div style="margin-top: 40px">
          <h3>ğŸ“Š Comparativo: PreferÃªncias vs Assinaturas</h3>
          <canvas id="grafico-comparativo" height="100"></canvas>
        </div>
        <div id="alertas-baixa-conversao"
          style="margin-top: 20px; padding: 12px; background: #fff3cd; border: 1px solid #ffeeba; border-radius: 6px;">
          <!-- Alertas serÃ£o inseridos aqui -->
        </div>
        <div id="sugestoes-acoes"
          style="margin-top: 20px; padding: 12px; background: #e8f5e9; border: 1px solid #c8e6c9; border-radius: 6px;">
          <!-- SugestÃµes serÃ£o inseridas aqui -->
        </div>
      </div>
    </section>


  </main>

  <!-- Modal CRUD (reaproveitado) -->
  <div class="modal-overlay" id="modal-edit-overlay" aria-hidden="true">
    <div class="modal">
      <h2 id="modal-edit-title"></h2>
      <div id="modal-edit-body"></div>
      <div class="modal-buttons">
        <button onclick="closeModal('modal-edit-overlay')">Cancelar</button>
        <button id="modal-edit-save">ğŸ’¾ Salvar</button>
      </div>
    </div>
  </div>


  <!-- Modal de resposta para solicitaÃ§Ãµes -->
  <div class="modal-overlay" id="modal-resposta-overlay" aria-hidden="true">
    <div class="modal">
      <h2 id="modal-resposta-titulo">ğŸ’¬ Responder SolicitaÃ§Ã£o</h2>
      <div>
        <label for="campo-resposta"><strong>Mensagem de resposta:</strong></label>
        <textarea id="campo-resposta" rows="5"
          style="width:100%; padding:8px; margin-top:6px; border:1px solid #ccc; border-radius:4px;"></textarea>
      </div>
      <div class="modal-buttons">
        <button onclick="fecharModalResposta()">Cancelar</button>
        <button onclick="confirmarRespostaSolicitacao()">Salvar</button>
      </div>
    </div>
  </div>


  <div id="visaoGeralContainer"
    style="margin-top:30px; background:#fff; padding:20px; border-radius:8px; border:1px solid #ccc;"></div>

  <!-- libs firebase compat (mantendo sua versÃ£o atual) -->
  <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore-compat.js"></script>

  <!-- seus scripts (main.js deve conter firebase.initializeApp e db) -->
  <script src="js/main.js"></script>
  <script src="js/subcollections.js"></script>

  <script src="functions/functions.js"></script>

  <script>
//    function closeModal(id) { document.getElementById(id).classList.remove('show'); document.getElementById(id).setAttribute('aria-hidden', 'true'); }
    //function openModal(id) { document.getElementById(id).classList.add('show'); document.getElementById(id).setAttribute('aria-hidden', 'false'); }

function openModal(id) {
  const modal = document.getElementById(id);
  if (modal) {
    modal.style.display = "block"; // garante que nÃ£o estÃ¡ oculto
    modal.classList.add("aberto");
    modal.setAttribute("aria-hidden", "false");
  } else {
    console.warn("Modal nÃ£o encontrado:", id);
  }
}


function closeModal(id) {
  const modal = document.getElementById(id);
  if (modal) {
    modal.classList.remove("aberto");
    modal.setAttribute("aria-hidden", "true");
    modal.style.display = "none"; // oculta novamente
  }
}


    async function abrirTab(tabId) {
      document.querySelectorAll('main section').forEach(sec => sec.style.display = 'none');
      document.querySelectorAll('aside#sidebar button').forEach(btn => btn.classList.remove('active'));
      const btn = document.querySelector(`aside#sidebar button[onclick="abrirTab('${tabId}')"]`);
      if (btn) btn.classList.add('active');
      const el = document.getElementById(tabId);
      if (el) el.style.display = 'block';

      // carrega conteÃºdo da aba
      //      if (tabId === 'usuarios') carregarUsuariosComFiltro();
      if (tabId === 'planos') carregarPlanos();
      else if (tabId === 'newsletters') {
        preencherFiltroTipoNewsletter();
        carregarNewsletters();
      }
      else if (tabId === 'tipo-newsletters') carregarTipoNewsLetters();
      // else if (tabId === 'leads') carregarLeads();
      else if (tabId === 'auditoria') carregarInteracoesAuditoria();
      else if (tabId === 'respostas_automaticas') carregarrespostas_automaticas();
      else if (tabId === 'aba-temas') carregarTemas_noticias();
      else if (tabId === 'relatorio-por-tipo') {
        await montarComboTiposNewsletter();
        gerarRelatorioPreferencias();
      }
      else if (tabId === 'relatorio-por-usuario') {
        document.getElementById("detalhes-relatorio-usuario").innerHTML = "";
        gerarRelatorioPorUsuario();
      }
      else if (tabId === 'relatorio-avaliacoes') {
        carregarRelatorioAvaliacoes();
      }
    }

    // inicializa com usuÃ¡rios visÃ­vel
    abrirTab('usuarios');
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const dados = JSON.parse(localStorage.getItem("usuarioLogado"));
      if (dados) {
        const nome = dados.nome || dados.email || "UsuÃ¡rio";
        const perfil = dados.tipo_perfil || "indefinido";

        const topo = document.getElementById("usuario-logado-topo");
        if (topo) {
          topo.innerText = `ğŸ‘¤${nome} (${perfil})`;
        }
      }
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // UsuÃ¡rios
    const ctxUsuarios = document.getElementById('grafico-usuarios').getContext('2d');
    window.graficoUsuarios = new Chart(ctxUsuarios, {
      type: 'doughnut',
      data: {
        labels: ['Ativos', 'Inativos'],
        datasets: [{
          data: [0, 0], // inicial vazio
          backgroundColor: ['#4caf50', '#f44336']
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'bottom' }
        }
      }
    });


    // Leads
    const ctxLeads = document.getElementById('grafico-leads').getContext('2d');
    window.graficoLeads = new Chart(ctxLeads, {
      type: 'bar',
      data: {
        labels: ['Novo', 'Em contato', 'Negociando', 'Convertido', 'Descartado'],
        datasets: [{
          label: 'Leads',
          data: [0, 0, 0, 0, 0],
          backgroundColor: ['#2196f3', '#03a9f4', '#ffc107', '#4caf50', '#9e9e9e']
        }]
      },
      options: {
        indexAxis: 'y',
        responsive: true,
        plugins: {
          legend: { display: false }
        }
      }
    });

    // Pagamentos
    const ctxPagamentos = document.getElementById('grafico-pagamentos').getContext('2d');
    window.graficoPagamentos = new Chart(ctxPagamentos, {
      type: 'doughnut',
      data: {
        labels: ['pago', 'pendente', 'cancelado'],
        datasets: [{
          data: [],
          backgroundColor: ['#4caf50', '#ff9800', '#9e9e9e']
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'bottom' }
        }
      }
    });

    // Assinaturas
    const ctxAssinaturas = document.getElementById('grafico-assinaturas').getContext('2d');
    window.graficoAssinaturas = new Chart(ctxAssinaturas, {
      type: 'bar',
      data: {
        labels: [], // serÃ¡ preenchido dinamicamente
        datasets: [{
          label: 'Assinaturas por Tipo',
          data: [],
          backgroundColor: [], // serÃ¡ preenchido dinamicamente
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { display: false }
        },
        scales: {
          y: { beginAtZero: true }
        }
      }
    });

    // comparativo preferencias/assinaturas
    const ctxComparativo = document.getElementById('grafico-comparativo').getContext('2d');
    window.graficoComparativo = new Chart(ctxComparativo, {
      type: 'bar',
      data: {
        labels: [],
        datasets: [
          {
            label: 'PreferÃªncias',
            data: [],
            backgroundColor: '#2196f3'
          },
          {
            label: 'Assinaturas',
            data: [],
            backgroundColor: '#4caf50'
          }
        ]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'bottom' }
        },
        scales: {
          y: { beginAtZero: true }
        }
      }
    });

  </script>

  <script src="js/site.js"></script>
</body>

</html>